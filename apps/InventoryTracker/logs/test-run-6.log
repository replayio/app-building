
> inventory-tracker@1.0.0 test
> tsx scripts/test.ts tests/dashboard.spec.ts


--- Killing stale processes ---

--- Cleaning up stale test branches ---
Deleting stale branch: test-worker-1771971720956-4y8ojy

--- Creating ephemeral branch: test-worker-1771972395977-cszkif ---
Branch created: br-lively-snow-aiboiriv

--- Initializing schema on test branch ---
Schema initialized.

--- Seeding test data ---
Seed data inserted successfully.

--- Removing stale recordings ---

--- Running Playwright: tests/dashboard.spec.ts ---
[2m[WebServer] [22m[33mâ ‹[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[1G[2m[WebServer] [22m[33mâ ™[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[1G[2m[WebServer] [22m[33mâ ¹[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[32mâˆš[39m Vite dev server ready on port 5173

Running 35 tests using 2 workers

[2m[WebServer] [22m(node:22935) [DEP0060] DeprecationWarning: The `util._extend` API is deprecated. Please use Object.assign() instead.
[2m[WebServer] [22m(Use `node --trace-deprecation ...` to show where the warning was created)
  âœ“   2 tests/dashboard.spec.ts:33:3 â€º NavigationHeader â€º Navigation link for Accounts navigates to AccountsPage (1.9s)
  âœ“   1 tests/dashboard.spec.ts:4:3 â€º NavigationHeader â€º Navigation header displays app branding and all navigation links (2.2s)
  âœ“   3 tests/dashboard.spec.ts:43:3 â€º NavigationHeader â€º Navigation link for Materials navigates to MaterialsPage (20.7s)
  âœ“   4 tests/dashboard.spec.ts:53:3 â€º NavigationHeader â€º Navigation link for Batches navigates to batch listing (27.8s)
  âœ“   5 tests/dashboard.spec.ts:63:3 â€º NavigationHeader â€º Navigation link for Transactions navigates to TransactionsPage (30.9s)
  âœ“   6 tests/dashboard.spec.ts:73:3 â€º NavigationHeader â€º Navigation link for Settings navigates to Settings page (30.6s)
  âœ“   7 tests/dashboard.spec.ts:83:3 â€º NavigationHeader â€º Active navigation link is visually highlighted for the current page (29.9s)
  âœ“   8 tests/dashboard.spec.ts:103:3 â€º LowInventoryAlerts â€º Low inventory alerts section displays with heading and warning icon (33.8s)
  âœ“   9 tests/dashboard.spec.ts:282:3 â€º MaterialsCategoriesOverview â€º Materials categories overview section displays with heading and icon (36.1s)
  âœ˜  10 tests/dashboard.spec.ts:113:3 â€º LowInventoryAlerts â€º Each low inventory alert shows severity, material name, current quantity, and reorder point (1.1m)
  -  12 tests/dashboard.spec.ts:173:3 â€º LowInventoryAlerts â€º Low inventory alert View Details link navigates to material detail page
  -  13 tests/dashboard.spec.ts:193:3 â€º LowInventoryAlerts â€º Low inventory alert Dismiss button removes the alert
  -  14 tests/dashboard.spec.ts:226:3 â€º LowInventoryAlerts â€º Low inventory alert Reorder button opens new transaction pre-filled for reorder
  -  15 tests/dashboard.spec.ts:250:3 â€º LowInventoryAlerts â€º Low inventory alerts section shows empty state when no materials are below reorder point
  âœ“  11 tests/dashboard.spec.ts:291:3 â€º MaterialsCategoriesOverview â€º Each category column shows category name, total items count, and total units count (54.5s)
  âœ“  16 tests/dashboard.spec.ts:343:3 â€º MaterialsCategoriesOverview â€º Clicking a material name navigates to the material detail page (31.2s)
  âœ“  17 tests/dashboard.spec.ts:320:3 â€º MaterialsCategoriesOverview â€º Each category shows a sample of materials with names and quantities (33.8s)
  âœ“  18 tests/dashboard.spec.ts:364:3 â€º MaterialsCategoriesOverview â€º View All Categories link navigates to MaterialsPage (12.6s)
  âœ“  20 tests/dashboard.spec.ts:399:3 â€º RecentTransactionsTable â€º Recent transactions table displays with correct column headers (16.2s)
  âœ“  19 tests/dashboard.spec.ts:374:3 â€º MaterialsCategoriesOverview â€º Materials categories overview updates when category filter is applied (24.0s)
  âœ“  21 tests/dashboard.spec.ts:418:3 â€º RecentTransactionsTable â€º Recent transactions table shows transaction rows with correct data (13.7s)
  âœ“  22 tests/dashboard.spec.ts:437:3 â€º RecentTransactionsTable â€º Recent transactions table shows multiple transactions in reverse chronological order (20.2s)
  âœ“  23 tests/dashboard.spec.ts:465:3 â€º RecentTransactionsTable â€º View Full Details link navigates to TransactionDetailPage (11.7s)
  âœ“  24 tests/dashboard.spec.ts:484:3 â€º RecentTransactionsTable â€º View All Transactions link navigates to TransactionsPage (14.1s)
  âœ“  26 tests/dashboard.spec.ts:533:3 â€º RecentTransactionsTable â€º Recent transactions table shows empty state when no transactions exist (16.8s)
  âœ“  25 tests/dashboard.spec.ts:494:3 â€º RecentTransactionsTable â€º Recent transactions table updates when date range filter is applied (29.2s)
  âœ“  27 tests/dashboard.spec.ts:552:3 â€º DateRangeFilter â€º Date range filter displays with label, date range, and calendar icon (13.3s)
  âœ“  28 tests/dashboard.spec.ts:567:3 â€º DateRangeFilter â€º Clicking the date range picker opens a calendar to select dates (16.9s)
  âœ“  30 tests/dashboard.spec.ts:617:3 â€º CategoryFilter â€º Category filter displays as a dropdown with "All Categories" default (25.1s)
  âœ“  29 tests/dashboard.spec.ts:583:3 â€º DateRangeFilter â€º Selecting a new date range updates all dashboard widgets (48.8s)
  âœ“  31 tests/dashboard.spec.ts:630:3 â€º CategoryFilter â€º Opening the category filter dropdown lists all material categories (32.9s)
  âœ“  32 tests/dashboard.spec.ts:660:3 â€º CategoryFilter â€º Selecting a category filters dashboard content to that category (57.1s)
  âœ“  33 tests/dashboard.spec.ts:685:3 â€º CategoryFilter â€º Selecting "All Categories" resets the filter to show all data (1.3m)
  âœ“  34 tests/dashboard.spec.ts:716:3 â€º NewTransactionButton â€º New Transaction button is displayed prominently with plus icon (31.5s)
  âœ“  35 tests/dashboard.spec.ts:732:3 â€º NewTransactionButton â€º Clicking New Transaction button navigates to NewTransactionPage (19.3s)
[replay.io]: Finishing up. This should only take a moment ...



  1) tests/dashboard.spec.ts:113:3 â€º LowInventoryAlerts â€º Each low inventory alert shows severity, material name, current quantity, and reorder point 

    [31mTest timeout of 60000ms exceeded.[39m

    Error: locator.textContent: Target page, context or browser has been closed

      133 |       await expect(page.getByTestId(`low-inventory-alert-severity-${materialId}`)).toBeVisible();
      134 |       const severityLabel = page.getByTestId(`low-inventory-alert-severity-label-${materialId}`);
    > 135 |       const labelText = await severityLabel.textContent();
          |                                             ^
      136 |       expect(["Warning", "Critical"]).toContain(labelText);
      137 |
      138 |       // Material name
        at /repo/apps/InventoryTracker/tests/dashboard.spec.ts:135:45

    Error Context: test-results/dashboard-LowInventoryAler-bd415--quantity-and-reorder-point/error-context.md

  1 failed
    tests/dashboard.spec.ts:113:3 â€º LowInventoryAlerts â€º Each low inventory alert shows severity, material name, current quantity, and reorder point 
  4 did not run
  30 passed (8.4m)

Playwright exited with code 1

=== REPLAY RECORDINGS METADATA ===
{"id":"c3c1fff1-f09e-4e80-a67e-160942e65c80","testResult":"passed"}
{"id":"27e0dc7a-d7a0-44d9-867c-2d4eedfe2b13","testResult":"passed"}
{"id":"b08502e0-6f13-4406-8651-a785e352bb04","testResult":"passed"}
{"id":"dd092348-75e7-4036-8d2e-1889a2f49b82","testResult":"passed"}
{"id":"5e8ae428-8045-447b-9975-fd4e39189ca0","testResult":"passed"}
{"id":"71ba6956-d049-4542-ac06-2729a0a1a771","testResult":"passed"}
{"id":"a58cdada-d807-4744-a95f-dbc1bb011e06","testResult":"passed"}
{"id":"fee3680a-005f-4f78-a58a-893dffc31681","testResult":"passed"}
{"id":"31baa517-febb-42e3-85d4-930fd1c70d60","testResult":"passed"}
{"id":"b6245f0b-3660-4273-a545-a12731a0890b","testResult":"timedOut"}
{"id":"9d04bd17-b35a-49c4-82ce-a318d3ee64d3","testResult":"passed"}
{"id":"388073b0-20f9-4d27-a331-03ac97420724","testResult":"passed"}
{"id":"f6b1361c-ed04-4721-aaa7-2a93d9534583","testResult":"passed"}
{"id":"f6287568-c859-492c-b8d0-f23ba36b7163","testResult":"passed"}
{"id":"9166ff71-7604-4d2a-9562-972275fd8376","testResult":"passed"}
{"id":"3b3441e3-b17c-4fbc-967a-1f7e19fc0e9f","testResult":"passed"}
{"id":"0dbd99e5-06f0-458f-8c4a-212f26d2153c","testResult":"passed"}
{"id":"7683d659-ac8e-4284-af83-e54c323bd6c9","testResult":"passed"}
{"id":"1d623ec7-bf7d-49a9-9924-963155a8c28c","testResult":"passed"}
{"id":"73e1deb9-0a16-4fa1-9bbb-00a2f034e865","testResult":"passed"}
{"id":"412c18ee-c768-4168-a732-8200c64195f9","testResult":"passed"}
{"id":"0c33cbae-aa7e-4224-aa6c-df866764c483","testResult":"passed"}
{"id":"28196b18-1f44-49b7-b8b3-c621e2fad030","testResult":"passed"}
{"id":"2d35142d-f7ad-4eee-943e-76d5493b2d94","testResult":"passed"}
{"id":"9739cd6b-1e8b-4416-95bf-0418c34ebdeb","testResult":"passed"}
{"id":"567d7202-1fd7-4608-883f-2214ff0de06e","testResult":"passed"}
{"id":"450a5d65-8791-4b9b-94e1-07afe0a5f2fd","testResult":"passed"}
{"id":"6e72ae38-2e3d-4ba5-99f6-eda6107eba41","testResult":"passed"}
{"id":"ff926e54-1a09-4c2f-886c-45951b552a23","testResult":"passed"}
{"id":"293f8758-753e-4207-b31c-85f9526c3eb5","testResult":"passed"}
{"id":"b9e23ab3-6e48-4041-aeb9-9281057e6e68","testResult":"passed"}
=== END REPLAY RECORDINGS METADATA ===

Uploading recording b6245f0b-3660-4273-a545-a12731a0890b (duration: 0)...
â ™ Initializingâ€¦
Uploading recordings...
   b6245f0bâ€¦  Each low inventory alert shows severity, materialâ€¦  6m ago  58.4s   

Uploaded recordings
 âœ”  b6245f0bâ€¦  Each low inventory alert shows severity, materialâ€¦  6m ago  58.4s  (uploaded) 

View recording at:
https://app.replay.io/recording/b6245f0b-3660-4273-a545-a12731a0890b
REPLAY UPLOADED: b6245f0b-3660-4273-a545-a12731a0890b

--- Cleaning up ---
Deleting ephemeral branch: test-worker-1771972395977-cszkif
Test script failed: TypeError: fetch failed
    at node:internal/deps/undici/undici:14902:13
    at async deleteBranch (/repo/apps/InventoryTracker/scripts/test.ts:76:15)
    at async main (/repo/apps/InventoryTracker/scripts/test.ts:310:5) {
  [cause]: Error: write ETIMEDOUT
      at WriteWrap.onWriteComplete [as oncomplete] (node:internal/stream_base_commons:87:19)
      at handleWriteReq (node:internal/stream_base_commons:59:21)
      at writeGeneric (node:internal/stream_base_commons:148:15)
      at Socket._writeGeneric (node:net:966:11)
      at Socket._write (node:net:978:8)
      at writeOrBuffer (node:internal/streams/writable:572:12)
      at _write (node:internal/streams/writable:501:10)
      at Writable.write (node:internal/streams/writable:510:10)
      at writeBuffer (node:internal/deps/undici/undici:6714:20)
      at writeH1 (node:internal/deps/undici/undici:6616:9) {
    errno: -110,
    code: 'ETIMEDOUT',
    syscall: 'write'
  }
}
