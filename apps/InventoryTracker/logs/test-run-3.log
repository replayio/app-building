
> inventory-tracker@1.0.0 test
> tsx scripts/test.ts tests/dashboard.spec.ts


--- Killing stale processes ---

--- Cleaning up stale test branches ---

--- Creating ephemeral branch: test-worker-1771970314324-gdek9t ---
Branch created: br-patient-waterfall-ai2vw5sx

--- Initializing schema on test branch ---
Schema initialized.

--- Seeding test data ---
Seed data inserted successfully.

--- Removing stale recordings ---

--- Running Playwright: tests/dashboard.spec.ts ---
[2m[WebServer] [22m[33mâ ‹[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[1G[2m[WebServer] [22m[33mâ ™[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[1G[2m[WebServer] [22m[33mâ ¹[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[1G[33mâ ¸[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[32mâˆš[39m Vite dev server ready on port 5173

Running 35 tests using 2 workers

[2m[WebServer] [22m(node:19292) [DEP0060] DeprecationWarning: The `util._extend` API is deprecated. Please use Object.assign() instead.
[2m[WebServer] [22m(Use `node --trace-deprecation ...` to show where the warning was created)
  âœ“   1 tests/dashboard.spec.ts:33:3 â€º NavigationHeader â€º Navigation link for Accounts navigates to AccountsPage (1.9s)
  âœ“   2 tests/dashboard.spec.ts:4:3 â€º NavigationHeader â€º Navigation header displays app branding and all navigation links (2.4s)
  âœ“   3 tests/dashboard.spec.ts:43:3 â€º NavigationHeader â€º Navigation link for Materials navigates to MaterialsPage (1.1s)
  âœ“   4 tests/dashboard.spec.ts:53:3 â€º NavigationHeader â€º Navigation link for Batches navigates to batch listing (1.2s)
  âœ“   5 tests/dashboard.spec.ts:63:3 â€º NavigationHeader â€º Navigation link for Transactions navigates to TransactionsPage (1.2s)
  âœ“   6 tests/dashboard.spec.ts:73:3 â€º NavigationHeader â€º Navigation link for Settings navigates to Settings page (1.2s)
  âœ“   7 tests/dashboard.spec.ts:83:3 â€º NavigationHeader â€º Active navigation link is visually highlighted for the current page (1.3s)
  âœ“   8 tests/dashboard.spec.ts:103:3 â€º LowInventoryAlerts â€º Low inventory alerts section displays with heading and warning icon (1.9s)
  âœ“   9 tests/dashboard.spec.ts:281:3 â€º MaterialsCategoriesOverview â€º Materials categories overview section displays with heading and icon (2.9s)
  âœ“  10 tests/dashboard.spec.ts:113:3 â€º LowInventoryAlerts â€º Each low inventory alert shows severity, material name, current quantity, and reorder point (4.4s)
  âœ“  11 tests/dashboard.spec.ts:290:3 â€º MaterialsCategoriesOverview â€º Each category column shows category name, total items count, and total units count (3.5s)
  âœ“  12 tests/dashboard.spec.ts:173:3 â€º LowInventoryAlerts â€º Low inventory alert View Details link navigates to material detail page (2.0s)
  âœ“  13 tests/dashboard.spec.ts:319:3 â€º MaterialsCategoriesOverview â€º Each category shows a sample of materials with names and quantities (3.4s)
  âœ“  14 tests/dashboard.spec.ts:193:3 â€º LowInventoryAlerts â€º Low inventory alert Dismiss button removes the alert (4.0s)
  âœ“  15 tests/dashboard.spec.ts:342:3 â€º MaterialsCategoriesOverview â€º Clicking a material name navigates to the material detail page (3.2s)
  âœ“  16 tests/dashboard.spec.ts:226:3 â€º LowInventoryAlerts â€º Low inventory alert Reorder button opens new transaction pre-filled for reorder (25.0s)
  âœ“  17 tests/dashboard.spec.ts:363:3 â€º MaterialsCategoriesOverview â€º View All Categories link navigates to MaterialsPage (35.5s)
  âœ˜  18 tests/dashboard.spec.ts:250:3 â€º LowInventoryAlerts â€º Low inventory alerts section shows empty state when no materials are below reorder point (1.1m)
  âœ“  19 tests/dashboard.spec.ts:373:3 â€º MaterialsCategoriesOverview â€º Materials categories overview updates when category filter is applied (54.4s)
  âœ“  20 tests/dashboard.spec.ts:417:3 â€º RecentTransactionsTable â€º Recent transactions table shows transaction rows with correct data (22.2s)
  âœ“  21 tests/dashboard.spec.ts:398:3 â€º RecentTransactionsTable â€º Recent transactions table displays with correct column headers (14.8s)
  âœ“  22 tests/dashboard.spec.ts:436:3 â€º RecentTransactionsTable â€º Recent transactions table shows multiple transactions in reverse chronological order (22.5s)
  âœ“  23 tests/dashboard.spec.ts:464:3 â€º RecentTransactionsTable â€º View Full Details link navigates to TransactionDetailPage (13.5s)
  âœ“  24 tests/dashboard.spec.ts:483:3 â€º RecentTransactionsTable â€º View All Transactions link navigates to TransactionsPage (13.6s)
  âœ“  26 tests/dashboard.spec.ts:531:3 â€º RecentTransactionsTable â€º Recent transactions table shows empty state when no transactions exist (20.1s)
  âœ“  25 tests/dashboard.spec.ts:493:3 â€º RecentTransactionsTable â€º Recent transactions table updates when date range filter is applied (31.1s)
  âœ“  27 tests/dashboard.spec.ts:550:3 â€º DateRangeFilter â€º Date range filter displays with label, date range, and calendar icon (13.4s)
  âœ“  28 tests/dashboard.spec.ts:565:3 â€º DateRangeFilter â€º Clicking the date range picker opens a calendar to select dates (15.8s)
  âœ“  30 tests/dashboard.spec.ts:615:3 â€º CategoryFilter â€º Category filter displays as a dropdown with "All Categories" default (12.5s)
  âœ“  29 tests/dashboard.spec.ts:581:3 â€º DateRangeFilter â€º Selecting a new date range updates all dashboard widgets (25.9s)
  âœ“  31 tests/dashboard.spec.ts:628:3 â€º CategoryFilter â€º Opening the category filter dropdown lists all material categories (18.4s)
  âœ“  32 tests/dashboard.spec.ts:658:3 â€º CategoryFilter â€º Selecting a category filters dashboard content to that category (37.3s)
  âœ“  34 tests/dashboard.spec.ts:713:3 â€º NewTransactionButton â€º New Transaction button is displayed prominently with plus icon (33.0s)
  âœ˜  33 tests/dashboard.spec.ts:683:3 â€º CategoryFilter â€º Selecting "All Categories" resets the filter to show all data (1.1m)
  âœ“  35 tests/dashboard.spec.ts:729:3 â€º NewTransactionButton â€º Clicking New Transaction button navigates to NewTransactionPage (25.4s)
[replay.io]: Finishing up. This should only take a moment ...



  1) tests/dashboard.spec.ts:250:3 â€º LowInventoryAlerts â€º Low inventory alerts section shows empty state when no materials are below reorder point 

    [31mTest timeout of 60000ms exceeded.[39m

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoHaveCount[2m([22m[32mexpected[39m[2m)[22m failed

    Locator:  locator('[data-testid="low-inventory-alert-row-2c95763c-7cce-4191-b30b-ace2e2306926"]')
    Expected: [32m0[39m
    Received: [31m1[39m

    Call log:
    [2m  - Expect "toHaveCount" with timeout 15000ms[22m
    [2m  - waiting for locator('[data-testid="low-inventory-alert-row-2c95763c-7cce-4191-b30b-ace2e2306926"]')[22m
    [2m    6 Ã— locator resolved to 1 element[22m
    [2m      - unexpected value "1"[22m


      269 |       await expect(
      270 |         page.locator(`[data-testid="low-inventory-alert-row-${materialId}"]`)
    > 271 |       ).toHaveCount(0, { timeout: 15000 });
          |         ^
      272 |     }
      273 |
      274 |     // Verify empty state
        at /repo/apps/InventoryTracker/tests/dashboard.spec.ts:271:9

    Error Context: test-results/dashboard-LowInventoryAler-14ee3-als-are-below-reorder-point/error-context.md

  2) tests/dashboard.spec.ts:683:3 â€º CategoryFilter â€º Selecting "All Categories" resets the filter to show all data 

    [31mTest timeout of 60000ms exceeded.[39m

    Error: expect.not.toHaveCount: Target page, context or browser has been closed

      704 |     // Should show all categories again
      705 |     const columns = page.locator("[data-testid^='category-column-']");
    > 706 |     await expect(columns).not.toHaveCount(1, { timeout: 15000 });
          |                               ^
      707 |     const finalCount = await columns.count();
      708 |     expect(finalCount).toBeGreaterThanOrEqual(3);
      709 |   });
        at /repo/apps/InventoryTracker/tests/dashboard.spec.ts:706:31

    Error Context: test-results/dashboard-CategoryFilter-S-ad636-the-filter-to-show-all-data/error-context.md

  2 failed
    tests/dashboard.spec.ts:250:3 â€º LowInventoryAlerts â€º Low inventory alerts section shows empty state when no materials are below reorder point 
    tests/dashboard.spec.ts:683:3 â€º CategoryFilter â€º Selecting "All Categories" resets the filter to show all data 
  33 passed (6.1m)

Playwright exited with code 1

=== REPLAY RECORDINGS METADATA ===
{"id":"96a6ee8c-79e3-4652-b527-583bb5a5c471","testResult":"passed"}
{"id":"a520d9be-e4d6-4cf1-b024-15de04e961ec","testResult":"passed"}
{"id":"d2337589-ded3-459c-b4ea-a6ef8379e799","testResult":"passed"}
{"id":"d1f70dd3-ea48-48fa-b73f-c14deca4be17","testResult":"passed"}
{"id":"033e572f-501b-4348-8da4-1155d57bee2c","testResult":"passed"}
{"id":"7030b941-7eee-4760-9d15-288e01b757da","testResult":"passed"}
{"id":"3a9c6ebb-4165-49f8-86ee-23b61bcbdc12","testResult":"passed"}
{"id":"acd17638-2dc2-4b5f-aea5-6c127e54aeb0","testResult":"passed"}
{"id":"fbcd52c1-ff06-4ec8-91e5-61a8277dc651","testResult":"passed"}
{"id":"2f6304aa-e3a3-4f19-b5bf-1bd4ff2ecf5d","testResult":"passed"}
{"id":"567ea182-644d-413b-8fd3-effef1e49d5a","testResult":"passed"}
{"id":"02322e9d-445e-47c8-bdf4-cb8b9d1bfd50","testResult":"passed"}
{"id":"469dec3a-7027-4bcb-904b-518401481e1f","testResult":"passed"}
{"id":"edb923d3-baf9-4335-9ca4-7b5ca5d1ce86","testResult":"passed"}
{"id":"44418ef6-0283-4dfb-9d99-f71470286ca2","testResult":"passed"}
{"id":"460e6a28-35f0-4421-8a6c-1a73d47b8801","testResult":"passed"}
{"id":"a2c41e91-c928-4476-9173-7b5e623a55df","testResult":"passed"}
{"id":"342d2816-31ee-44aa-b2a5-4fae782fa19c","testResult":"timedOut"}
{"id":"3f503c7e-6849-4669-9a1f-69b73e1e674d","testResult":"passed"}
{"id":"dc43cea1-1c67-405b-8db7-78840a9103c6","testResult":"passed"}
{"id":"43690ea3-9470-4d0a-a03c-90a17fc742d6","testResult":"passed"}
{"id":"98403e06-8b2e-4316-9372-058f55bae1c9","testResult":"passed"}
{"id":"34c97910-ac48-4539-b68c-c22bdbccb418","testResult":"passed"}
{"id":"f03a6c24-8a14-4da2-8258-43fee74b957d","testResult":"passed"}
{"id":"e581a283-4e69-4833-b03f-5719af2ded23","testResult":"passed"}
{"id":"f961a022-3525-4baf-9221-2efa5f142fa9","testResult":"passed"}
{"id":"4a69fa01-1451-452c-947f-26241c2f8ae6","testResult":"passed"}
{"id":"944d4ab6-e1ab-4707-b1f8-3f297d68e1de","testResult":"passed"}
{"id":"544ec096-3f2f-41bd-b376-6f706c59aead","testResult":"passed"}
{"id":"e100453e-d7fb-4975-9537-681bd361e0ec","testResult":"passed"}
{"id":"d76ef041-ee44-4eca-b79d-368b91da05f6","testResult":"passed"}
{"id":"9f377c33-ec52-4dff-8e91-5468a90b1db7","testResult":"passed"}
{"id":"a877577a-9252-4d00-952d-3199c53a5a8e","testResult":"timedOut"}
{"id":"807718ad-00c5-491f-8df1-f32690ea6787","testResult":"passed"}
{"id":"469a8afc-5b2b-475d-be50-f0c1898f8e34","testResult":"passed"}
=== END REPLAY RECORDINGS METADATA ===

Uploading recording 342d2816-31ee-44aa-b2a5-4fae782fa19c (duration: 0)...
â ™ Initializingâ€¦
Uploading recordings...
   342d2816â€¦  Low inventory alerts section shows empty state wheâ€¦  5m ago  58.6s   

Uploaded recordings
 âœ”  342d2816â€¦  Low inventory alerts section shows empty state wheâ€¦  5m ago  58.6s  (uploaded) 

View recording at:
https://app.replay.io/recording/342d2816-31ee-44aa-b2a5-4fae782fa19c
REPLAY UPLOADED: 342d2816-31ee-44aa-b2a5-4fae782fa19c

--- Cleaning up ---
Deleting ephemeral branch: test-worker-1771970314324-gdek9t
