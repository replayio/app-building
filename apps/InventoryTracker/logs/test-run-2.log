
> inventory-tracker@1.0.0 test
> tsx scripts/test.ts tests/dashboard.spec.ts


--- Killing stale processes ---

--- Cleaning up stale test branches ---

--- Creating ephemeral branch: test-worker-1771969756792-s49fe7 ---
Branch created: br-restless-silence-aiup42e6

--- Initializing schema on test branch ---
Schema initialized.

--- Seeding test data ---
Seed data inserted successfully.

--- Removing stale recordings ---

--- Running Playwright: tests/dashboard.spec.ts ---
[2m[WebServer] [22m[33mâ ‹[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[1G[33mâ ™[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[1G[2m[WebServer] [22m[33mâ ¹[39m Waiting for Vite dev server to be ready on port 5173
[2m[WebServer] [22m[32mâˆš[39m Vite dev server ready on port 5173

Running 35 tests using 2 workers

[2m[WebServer] [22m(node:18034) [DEP0060] DeprecationWarning: The `util._extend` API is deprecated. Please use Object.assign() instead.
[2m[WebServer] [22m(Use `node --trace-deprecation ...` to show where the warning was created)
  âœ“   1 tests/dashboard.spec.ts:33:3 â€º NavigationHeader â€º Navigation link for Accounts navigates to AccountsPage (1.9s)
  âœ“   2 tests/dashboard.spec.ts:4:3 â€º NavigationHeader â€º Navigation header displays app branding and all navigation links (2.2s)
  âœ“   3 tests/dashboard.spec.ts:43:3 â€º NavigationHeader â€º Navigation link for Materials navigates to MaterialsPage (1.1s)
  âœ“   4 tests/dashboard.spec.ts:53:3 â€º NavigationHeader â€º Navigation link for Batches navigates to batch listing (1.1s)
  âœ“   5 tests/dashboard.spec.ts:63:3 â€º NavigationHeader â€º Navigation link for Transactions navigates to TransactionsPage (1.1s)
  âœ“   6 tests/dashboard.spec.ts:73:3 â€º NavigationHeader â€º Navigation link for Settings navigates to Settings page (1.2s)
  âœ“   7 tests/dashboard.spec.ts:83:3 â€º NavigationHeader â€º Active navigation link is visually highlighted for the current page (1.2s)
  âœ“   8 tests/dashboard.spec.ts:103:3 â€º LowInventoryAlerts â€º Low inventory alerts section displays with heading and warning icon (2.0s)
  âœ“   9 tests/dashboard.spec.ts:281:3 â€º MaterialsCategoriesOverview â€º Materials categories overview section displays with heading and icon (2.0s)
  âœ“  11 tests/dashboard.spec.ts:290:3 â€º MaterialsCategoriesOverview â€º Each category column shows category name, total items count, and total units count (3.4s)
  âœ“  10 tests/dashboard.spec.ts:113:3 â€º LowInventoryAlerts â€º Each low inventory alert shows severity, material name, current quantity, and reorder point (5.3s)
  âœ“  13 tests/dashboard.spec.ts:173:3 â€º LowInventoryAlerts â€º Low inventory alert View Details link navigates to material detail page (2.2s)
  âœ“  12 tests/dashboard.spec.ts:319:3 â€º MaterialsCategoriesOverview â€º Each category shows a sample of materials with names and quantities (3.3s)
  âœ“  15 tests/dashboard.spec.ts:342:3 â€º MaterialsCategoriesOverview â€º Clicking a material name navigates to the material detail page (2.5s)
  âœ“  16 tests/dashboard.spec.ts:363:3 â€º MaterialsCategoriesOverview â€º View All Categories link navigates to MaterialsPage (1.9s)
  âœ“  17 tests/dashboard.spec.ts:373:3 â€º MaterialsCategoriesOverview â€º Materials categories overview updates when category filter is applied (4.2s)
  âœ“  18 tests/dashboard.spec.ts:398:3 â€º RecentTransactionsTable â€º Recent transactions table displays with correct column headers (1.9s)
  âœ“  19 tests/dashboard.spec.ts:417:3 â€º RecentTransactionsTable â€º Recent transactions table shows transaction rows with correct data (1.9s)
  âœ“  20 tests/dashboard.spec.ts:436:3 â€º RecentTransactionsTable â€º Recent transactions table shows multiple transactions in reverse chronological order (2.5s)
  âœ˜  14 tests/dashboard.spec.ts:193:3 â€º LowInventoryAlerts â€º Low inventory alert Dismiss button removes the alert (17.3s)
  -  22 tests/dashboard.spec.ts:226:3 â€º LowInventoryAlerts â€º Low inventory alert Reorder button opens new transaction pre-filled for reorder
  -  23 tests/dashboard.spec.ts:250:3 â€º LowInventoryAlerts â€º Low inventory alerts section shows empty state when no materials are below reorder point
  âœ“  21 tests/dashboard.spec.ts:464:3 â€º RecentTransactionsTable â€º View Full Details link navigates to TransactionDetailPage (1.9s)
  âœ˜  24 tests/dashboard.spec.ts:493:3 â€º RecentTransactionsTable â€º Recent transactions table updates when date range filter is applied (2.8s)
  âœ“  25 tests/dashboard.spec.ts:483:3 â€º RecentTransactionsTable â€º View All Transactions link navigates to TransactionsPage (2.5s)
  âœ“  26 tests/dashboard.spec.ts:550:3 â€º DateRangeFilter â€º Date range filter displays with label, date range, and calendar icon (1.8s)
  âœ“  28 tests/dashboard.spec.ts:565:3 â€º DateRangeFilter â€º Clicking the date range picker opens a calendar to select dates (2.6s)
  âœ“  27 tests/dashboard.spec.ts:531:3 â€º RecentTransactionsTable â€º Recent transactions table shows empty state when no transactions exist (4.2s)
  âœ˜  29 tests/dashboard.spec.ts:581:3 â€º DateRangeFilter â€º Selecting a new date range updates all dashboard widgets (2.9s)
  âœ“  30 tests/dashboard.spec.ts:615:3 â€º CategoryFilter â€º Category filter displays as a dropdown with "All Categories" default (1.9s)
  âœ“  31 tests/dashboard.spec.ts:658:3 â€º CategoryFilter â€º Selecting a category filters dashboard content to that category (3.0s)
  âœ“  32 tests/dashboard.spec.ts:628:3 â€º CategoryFilter â€º Opening the category filter dropdown lists all material categories (2.3s)
  âœ“  34 tests/dashboard.spec.ts:713:3 â€º NewTransactionButton â€º New Transaction button is displayed prominently with plus icon (18.3s)
  âœ“  33 tests/dashboard.spec.ts:683:3 â€º CategoryFilter â€º Selecting "All Categories" resets the filter to show all data (45.0s)
  âœ“  35 tests/dashboard.spec.ts:729:3 â€º NewTransactionButton â€º Clicking New Transaction button navigates to NewTransactionPage (31.0s)
[replay.io]: Finishing up. This should only take a moment ...



  1) tests/dashboard.spec.ts:193:3 â€º LowInventoryAlerts â€º Low inventory alert Dismiss button removes the alert 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoHaveCount[2m([22m[32mexpected[39m[2m)[22m failed

    Locator:  locator('[data-testid^=\'low-inventory-alert-row-\']').filter({ has: locator('[data-testid^=\'low-inventory-alert-material-name-\']').filter({ hasText: 'Copper Wire' }) })
    Expected: [32m0[39m
    Received: [31m1[39m
    Timeout:  15000ms

    Call log:
    [2m  - Expect "toHaveCount" with timeout 15000ms[22m
    [2m  - waiting for locator('[data-testid^=\'low-inventory-alert-row-\']').filter({ has: locator('[data-testid^=\'low-inventory-alert-material-name-\']').filter({ hasText: 'Copper Wire' }) })[22m
    [2m    18 Ã— locator resolved to 1 element[22m
    [2m       - unexpected value "1"[22m


      215 |         has: page.locator("[data-testid^='low-inventory-alert-material-name-']", { hasText: "Copper Wire" }),
      216 |       })
    > 217 |     ).toHaveCount(0, { timeout: 15000 });
          |       ^
      218 |
      219 |     // Other alerts should still be visible (at least one remains)
      220 |     const alertsAfter = page.locator("[data-testid^='low-inventory-alert-row-']");
        at /repo/apps/InventoryTracker/tests/dashboard.spec.ts:217:7

    Error Context: test-results/dashboard-LowInventoryAler-18e09-ss-button-removes-the-alert/error-context.md

  2) tests/dashboard.spec.ts:493:3 â€º RecentTransactionsTable â€º Recent transactions table updates when date range filter is applied 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected substring: [32m"Jan"[39m
    Received string:    [31m"Feb 15, 2026"[39m

      525 |       const dateText = await page.getByTestId(`recent-transaction-date-${txnId}`).textContent();
      526 |       expect(dateText).toContain("2026");
    > 527 |       expect(dateText).toContain("Jan");
          |                        ^
      528 |     }
      529 |   });
      530 |
        at /repo/apps/InventoryTracker/tests/dashboard.spec.ts:527:24

    Error Context: test-results/dashboard-RecentTransactio-3056b-ate-range-filter-is-applied/error-context.md

  3) tests/dashboard.spec.ts:581:3 â€º DateRangeFilter â€º Selecting a new date range updates all dashboard widgets 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected substring: [32m"Feb"[39m
    Received string:    [31m"Jan 20, 2026"[39m

      603 |       const txnId = rowTestId!.replace("recent-transaction-row-", "");
      604 |       const dateText = await page.getByTestId(`recent-transaction-date-${txnId}`).textContent();
    > 605 |       expect(dateText).toContain("Feb");
          |                        ^
      606 |     }
      607 |
      608 |     // Low inventory alerts and categories overview should still be visible
        at /repo/apps/InventoryTracker/tests/dashboard.spec.ts:605:24

    Error Context: test-results/dashboard-DateRangeFilter--436d4-dates-all-dashboard-widgets/error-context.md

  3 failed
    tests/dashboard.spec.ts:193:3 â€º LowInventoryAlerts â€º Low inventory alert Dismiss button removes the alert 
    tests/dashboard.spec.ts:493:3 â€º RecentTransactionsTable â€º Recent transactions table updates when date range filter is applied 
    tests/dashboard.spec.ts:581:3 â€º DateRangeFilter â€º Selecting a new date range updates all dashboard widgets 
  2 did not run
  30 passed (2.0m)

Playwright exited with code 1

=== REPLAY RECORDINGS METADATA ===
{"id":"361a1ac0-fba7-4184-b448-949c206f6c43","testResult":"passed"}
{"id":"042c3b96-e035-4c99-b76b-a6ba5b4c209d","testResult":"passed"}
{"id":"521a6986-009b-4880-a7bc-a65a912341d1","testResult":"passed"}
{"id":"fa4acfc0-5d35-41c4-a521-f467de7af66c","testResult":"passed"}
{"id":"355f7bb1-6ebf-4772-89d8-b255f2059c3b","testResult":"passed"}
{"id":"e729d665-53a7-496a-bf67-58c4258b5ff8","testResult":"passed"}
{"id":"0e8cca26-89e2-4078-98fe-1db31c5d1f2b","testResult":"passed"}
{"id":"d0225eff-083f-4f53-b3ee-be5c7c7d10d0","testResult":"passed"}
{"id":"bc4bd064-4481-425c-9bef-7b7dcc2f7f86","testResult":"passed"}
{"id":"b4fbe4db-6011-4c2e-9831-3822a3f32790","testResult":"passed"}
{"id":"96ad1a8e-476b-49aa-bd02-24f5b1c9c65e","testResult":"passed"}
{"id":"974954fd-42cb-447e-b457-c85e4457047c","testResult":"passed"}
{"id":"ae842fe8-8601-45c8-bd99-fbc8d144db76","testResult":"passed"}
{"id":"49b55bf9-56db-41fd-9dce-afb1652edef5","testResult":"failed"}
{"id":"75c292b0-d065-45e6-86c6-819c2444d583","testResult":"passed"}
{"id":"0de1fabc-0a2c-4414-b041-103190198f59","testResult":"passed"}
{"id":"21781344-5a0d-448a-8616-48515f91b3aa","testResult":"passed"}
{"id":"9c7b2886-9698-47b2-927f-1a9f0d7b3725","testResult":"passed"}
{"id":"52b8baea-af5e-4475-b043-6829ca3c53c0","testResult":"passed"}
{"id":"6523431d-4176-4318-bd42-59b58a526ec6","testResult":"passed"}
{"id":"ac4a1f13-14b9-4e25-afb5-93e1602b72f6","testResult":"passed"}
{"id":"acd9b04b-37f6-46ad-ab7d-c214895ac102","testResult":"failed"}
{"id":"30107ca3-9ca9-485e-84ab-c87908995539","testResult":"passed"}
{"id":"6114826d-dc20-4f74-96ae-acb95098ed4a","testResult":"passed"}
{"id":"3ada28a1-ab5c-4aec-b2f2-08b4c2df355b","testResult":"passed"}
{"id":"0fac86eb-98c2-4b1e-a587-0db95585182b","testResult":"passed"}
{"id":"d2e20eff-8268-4823-bcb4-051d8608aa41","testResult":"failed"}
{"id":"8935306e-d32f-4ed1-9248-02f611b3a280","testResult":"passed"}
{"id":"8860967d-0202-4fd5-a67f-86dabdd400af","testResult":"passed"}
{"id":"8d347089-6551-47a2-ae50-24d06e339a3a","testResult":"passed"}
{"id":"d84eea25-159b-48c9-a3df-8d61815ffa26","testResult":"passed"}
{"id":"408004a6-17a3-4376-ba8c-0f4ed548534d","testResult":"passed"}
{"id":"ba836473-712e-4a58-a9b2-10dd2b1e68c0","testResult":"passed"}
=== END REPLAY RECORDINGS METADATA ===

Uploading recording 49b55bf9-56db-41fd-9dce-afb1652edef5 (duration: 0)...
â ™ Initializingâ€¦
Uploading recordings...
   49b55bf9â€¦  Low inventory alert Dismiss button removes the aleâ€¦  2m ago  16.9s   

Uploaded recordings
 âœ”  49b55bf9â€¦  Low inventory alert Dismiss button removes the aleâ€¦  2m ago  16.9s  (uploaded) 

View recording at:
https://app.replay.io/recording/49b55bf9-56db-41fd-9dce-afb1652edef5
REPLAY UPLOADED: 49b55bf9-56db-41fd-9dce-afb1652edef5

--- Cleaning up ---
Deleting ephemeral branch: test-worker-1771969756792-s49fe7
